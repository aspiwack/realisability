#+TITLE: Krivine realisability from scratch
#+AUTHOR: Arnaud Spiwack


* TODO Abstract

* TODO Introduction

* TODO Realisability in a few words

* Simple types

** Simply typed Î»-calculus

 Assume a set $I$ of individuals

 $$
 u,v ::= Î»x.u | u v | i âˆˆ I
 a,b ::= Î¹ | a â†’ b
 $$

 Typing rules
 $$
 Î“,x:a âŠ¢ u : b
 -------------
 Î“ âŠ¢ Î»x. u : a â†’ b

 Î“ âŠ¢ u : a â†’ b   Î“ âŠ¢ v : a
 -------------------------
 Î“ âŠ¢ u v : b

 ----------
 Î“ âŠ¢ i : Î¹
 $$

** Operational semantics

Given by a Krivine machine

$$
Ï€ ::= âˆ™ | u â‹… Ï€
c ::= u â‹† Ï€
$$

$$
u v â‹† Ï€ ~> u â‹† v â‹… Ï€
Î»x. u â‹† v â‹… Ï€ ~> u[v] â‹† Ï€
$$

** Realisability model
Let $T$ be the set of closed terms, $Î $ the set of (closed) stacks and
$C$ the set of commands

Fix a pole $âŠ¥ âˆˆ ğ’«(C)$, closed by anti-reduction. The model is
parametrised by this pole.

Define acceptors as sets of stacks and realisers as sets of terms
$$
|a â†’ b| âˆˆ ğ’«(Î )
|a â†’ b| â‰œ ||a|| â‹… |b|

|Î¹| âˆˆ ğ’«(Î )
|Î¹| â‰œ I^âŠ¥

||a|| âˆˆ ğ’«(C)
||a|| â‰œ |a|^âŠ¥
$$

*** TODO Define orthogonals

** Adequation

We will say that a sequent $x_1:a1,â€¦,x_n:a_n âŠ¢ u : b$ is /adequat/ if

$$
âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||. u[v_1,â€¦,v_n] âˆˆ ||b||
$$

Our goal is to show that every derivable sequent is adequat. In
particular, for closed terms, that:
$$
âŠ¢ u : b âŸ¹ u âˆˆ ||b||
$$

This is not a composable property. It can be, however, strengthened to
a property which we will be able to compose. Namely that all the
typing rules are adequat.

This can be phrased as /all typing rule preserve adequacy of
sequents/. In other words: if all premises are adequat then the
conclusion is adequat.

We need to prove
$$
(âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||, vâˆˆ||a||. u[v,v_1,â€¦,v_n] âˆˆ ||b||) âŸ¹ (âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||. Î»x. u[v_1,â€¦,v_n] âˆˆ ||a â†’ b||)
(âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||. u[v_1,â€¦,v_n] âˆˆ ||a â†’ b||) âˆ§ (âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||. v âˆˆ ||a||) âŸ¹ (âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||. (u v)[v_1,â€¦,v_n] âˆˆ ||b||)
âˆ€ v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||. iâˆˆ||Î¹||
$$

- Abstraction :: let $v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||$, we want to prove
                 that $Î»x. u âˆˆ ||a â†’ b|| = (||a|| â‹… |b|)^âŠ¥$. That is,
                 that $âˆ€ v_0 âˆˆ ||a||, Ï€ âˆˆ |b|, Î»x. u[v_1,â€¦,v_n] â‹† v_0 â‹…
                 Ï€ âˆˆ âŠ¥$.

                 By anti-reduction, it is sufficient to prove that
                 $u[v_0,v_1,â€¦,v_n] â‹† Ï€ âˆˆ âŠ¥$, which holds by
                 hypothesis.

- Application :: again, let $v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||$, we want to
                 prove that $(u v)[v_1,â€¦,v_n] âˆˆ ||b|| = |b|^âŠ¥$. That
                 is, that $forall Ï€âˆˆ|b|, (u v)[v_1,â€¦,v_n] â‹† Ï€ âˆˆ âŠ¥$.

                 By anti-reduction, it is sufficient to prove that
                 $u[v_1,â€¦,v_n] â‹† v[v_1,â€¦,v_n] â‹… Ï€ âˆˆ âŠ¥$. By hypothesis,
                 $v[v_1,â€¦,v_n] âˆˆ ||a||$, therefore $v[v_1,â€¦,v_n] â‹… Ï€
                 âˆˆ ||a|| â‹… |b| = |a â†’ b|$. By hypothesis $u[v_1,â€¦,v_n]
                 âˆˆ ||a â†’ b||=|a â†’ b|^âŠ¥$, in particular, $u[v_1,â€¦,v_n]
                 â‹† Ï€ âˆˆ âŠ¥$ (qed).

- Individuals :: once more, let $v_1âˆˆ||a_1||, â€¦, v_nâˆˆ||a_n||$, which
                 we can, this time, promptly ignore. We want to prove
                 that $i âˆˆ ||I|| = I^{âŠ¥âŠ¥}$. Which holds since, by
                 definition, $i âˆˆ I âŠ† I^{âŠ¥âŠ¥}$.

Remark: this latter property follows from the fact that $||I||$ is a
double-orthogonal. Other types whose set of realiser is a
double-orthogonal will enjoy similarly direct proofs for there
introduction rule.

** Proving properties

* TODO Adding polymorphism: System F

* TODO Adding non-termination

* TODO Adding sum and products

* Further reading

- This is call-by-name
- Sequent calculus & polarisation: http://assert-false.net/arnaud/papers/A%20dissection%20of%20L.pdf
  - Also call-by-push-value [TODO]
- Kriving realisability and sequent calculus: http://guillaume.munch.name/files/focalisation_and_classical_realisability_long.pdf
